{% extends 'base.html' %}

{% block title %}PopQuiz - Home{% endblock %}

{% block content %}
<div class="mb-8">
    <h1 class="text-3xl font-bold text-gray-800 mb-2">Welcome to PopQuiz</h1>
    <p class="text-gray-600">Vote on your favorite pop culture and see how your tastes compare with your team!</p>
</div>

<div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
    <div class="lg:col-span-2 space-y-8">
        <div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Categories</h2>
            {% if categories %}
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    {% for category in categories %}
                        <a href="{% url 'category_detail' category.slug %}" class="block bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition duration-200">
                            <h3 class="text-lg font-semibold text-indigo-600 mb-2">Vote for {{ category.name }}</h3>
                            {% if category.description %}
                                <p class="text-gray-600 mb-3">{{ category.description }}</p>
                            {% endif %}
                            <p class="text-sm text-gray-500">{{ category.item_count }} item{{ category.item_count|pluralize }}</p>
                        </a>
                    {% endfor %}
                </div>
            {% else %}
                <div class="bg-white rounded-lg shadow-md p-6 text-center text-gray-600">
                    <p>No categories yet. Ask an admin to create some!</p>
                </div>
            {% endif %}
        </div>

        <div>
            <h2 class="text-xl font-semibold text-gray-800 mb-4">Compare Tastes</h2>
            <div class="bg-white rounded-lg shadow-md p-4">
                <p class="text-gray-600 text-sm mb-4">See how compatible two team members are!</p>
                <form id="compare-form" class="flex flex-wrap items-end gap-3">
                    <div class="flex-1 min-w-[150px]">
                        <label for="user1" class="block text-sm font-medium text-gray-700 mb-1">First person</label>
                        <select id="user1" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm">
                            <option value="">Select...</option>
                            {% for member in users %}
                                <option value="{{ member.username }}">{{ member.first_name }} {{ member.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <div class="flex-1 min-w-[150px]">
                        <label for="user2" class="block text-sm font-medium text-gray-700 mb-1">Second person</label>
                        <select id="user2" class="w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 text-sm">
                            <option value="">Select...</option>
                            {% for member in users %}
                                <option value="{{ member.username }}">{{ member.first_name }} {{ member.last_name }}</option>
                            {% endfor %}
                        </select>
                    </div>
                    <button type="submit" class="bg-indigo-600 text-white py-2 px-6 rounded-md hover:bg-indigo-700 transition duration-200 text-sm font-medium">
                        Compare
                    </button>
                </form>
                <script>
                    document.getElementById('compare-form').addEventListener('submit', function(e) {
                        e.preventDefault();
                        var user1 = document.getElementById('user1').value;
                        var user2 = document.getElementById('user2').value;
                        if (user1 && user2 && user1 !== user2) {
                            window.location.href = '/compare/' + user1 + '/' + user2 + '/';
                        } else if (user1 === user2) {
                            alert('Please select two different people to compare.');
                        } else {
                            alert('Please select two people to compare.');
                        }
                    });
                </script>
            </div>
        </div>
    </div>

    <div>
        <h2 class="text-xl font-semibold text-gray-800 mb-4">Team Members</h2>
        <div class="bg-white rounded-lg shadow-md divide-y divide-gray-100">
            {% for member in users %}
                <a href="{% url 'profile' member.username %}" class="block px-4 py-3 hover:bg-gray-50 transition duration-200">
                    <span class="text-gray-800">{{ member.first_name }} {{ member.last_name }}</span>
                </a>
            {% empty %}
                <p class="px-4 py-3 text-gray-600">No team members yet.</p>
            {% endfor %}
        </div>
    </div>
</div>
{% endblock %}
